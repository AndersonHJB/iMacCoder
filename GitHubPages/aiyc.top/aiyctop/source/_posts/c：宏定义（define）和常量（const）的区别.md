---
title: C++：宏定义（#define）和常量（const）的区别
tags: []
id: '1798'
categories:
  - - C++一对一辅导
date: 2021-07-13 23:18:59
---

![在这里插入图片描述](https://img-blog.csdnimg.cn/20210713232517861.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzMjU0NzY2,size_16,color_FFFFFF,t_70) 你好，我是悦创。 最近开始准备一边复习 C++ 一遍备课和研究，一边记录一些遇到的编程中的小知识点。 今天我的读者跟我说：在测试对矩阵进行 SVD 分解时，需要定义矩阵的行和列的大小，我习惯性的用宏定义来定义了这两个变量，在运行的时候，就开始思考宏定义和常量之间有些什么样的分别。 参考了一些别人的说法，自己在这里做一个小小的总结。

## 类型和安全检查不同

*   宏定义是字符替换，没有数据类型的区别，同时这种替换没有类型安全检查，可能产生边际效应等错误；
    
*   const 常量是常量的声明，有类型区别，需要在编译阶段进行类型检查
    

## 编译器处理不同

*   宏定义是一个“编译时”概念，在预处理阶段展开，不能对宏定义进行调试，生命周期结束与编译时期；
    
*   const 常量是一个“运行时”概念，在程序运行使用，类似于一个只读行数据
    

## 存储方式不同

*   宏定义是直接替换，不会分配内存，存储与程序的代码段中；
*   const 常量需要进行内存分配，存储与程序的数据段中

## 定义域不同

```cpp
    void f1 ()
{

    #define N 12
    const int n 12;

}

    void f2 ()
{
    cout<<N <<endl; //正确，N已经定义过，不受定义域限制
    cout<<n <<endl; //错误，n定义域只在f1函数中
}
```

## 定义后能否取消

*   宏定义可以通过 `#undef` 来使之前的宏定义失效
    
*   const 常量定义后将在定义域内永久有效
    

```cpp
void f1()
{
  #define N 12
  const int n = 12;

  #undef N //取消宏定义后，即使在f1函数中，N也无效了
  #define N 21//取消后可以重新定义
}
```

#### 是否可以做函数参数

*   宏定义不能作为参数传递给函数
    
*   const 常量可以在函数的参数列表中出现
    

## 多角度分析

**角度1**： 就定义常量说的话， const 定义的常数是变量也带类型， `#define` 定义的只是个常数不带类型。 **角度2**： 就起作用的阶段而言，`#define` 是在编译的预处理阶段起作用，而 const 是在编译、运行的时候起作用。 **角度3**： 就起作用的方式而言，`#define` 只是简单的字符串替换，没有类型检查。而 const 有对应的数据类型，是要进行判断的，可以避免一些低级的错误。 正因为 define 只是简单的字符串替换会导致边界效应，具体举例可以参考下面代码：

```cpp
#define N 2+3     // 我们预想的 N 值是 5，我们这样使用 
double a = N/2.0;  // 我们预想的  a 的值是 2.5，可实际上 a 的值是 3.5
```

**角度4**： 就空间占用而言， 例如：

```cpp
#define PI 3.14     //预处理后 占用代码段空间
const float PI=3.14;    // 本质上还是一个 float，占用数据段空间
```

```cpp
#include <iostream>

int main() {
    #define PI 3.1415926
    const float PI2 = 3.1415926;
    std::cout << sizeof(PI) << sizeof(PI2);
    return 0;
}
```

**角度5**： 从代码调试的方便程度而言, const 常量可以进行调试的，`#define` 是不能进行调试的，因为在预编译阶段就已经替换掉了 **角度6**： 从是否可以再定义的角度而言, const 不足的地方，是与生俱来的，const 不能重定义，而 `#define` 可以通过 `#undef` 取消某个符号的定义，再重新定义。

> AI悦创·推出辅导班啦，包括「Python 语言辅导班、C++辅导班、算法/数据结构辅导班」，全部都是一对一教学：一对一辅导 + 一对一答疑 + 布置作业 + 项目实践等。QQ、微信在线，随时响应！V：Jiabcdefh ![在这里插入图片描述](https://img-blog.csdnimg.cn/20210713231810701.png)