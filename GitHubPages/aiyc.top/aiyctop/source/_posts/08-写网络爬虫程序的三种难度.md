---
title: 08-写网络爬虫程序的三种难度
tags: []
id: '753'
categories:
  - - Python3 网络爬虫系统教学
date: 2020-07-26 08:26:43
---

写爬虫，是一个非常考验综合实力的活儿。有时候，你轻而易举地就抓取到了想要的数据；有时候，你费尽心思却毫无所获。 好多 Python 爬虫的入门教程都是一行代码就把你骗上了“贼船”，等上了贼船才发现，水好深～ 比如爬取一个网页可以是很简单的一行代码：

```python
r = requests.get('http://news.baidu.com')
```

非常的简单，但它的作用也仅仅是**爬取一个网页**，而一个有用的爬虫远远不止于**爬取一个网页**。 一个有用的爬虫，只需两个词来衡量：

*   数量：能否抓全所有该类数据
*   效率：抓完所有数据需要多久一天还是一个月

但要做到这两个词，却是要下很多功夫。自己下功夫是一方面，也很重要的是你要抓全的目标网站给你出了多少难题。综合起来，就写一个爬虫有多少难度。

## 1\. 网络爬虫难度一：只需爬取 html 网页但要上规模

这里我们举个新闻爬虫的例子。大家都用过百度的新闻搜索吧，我就拿它的爬虫来讲讲实现上的难度。 新闻网站基本上不设防，新闻内容都在网页的 html 代码里了，抓全一个网页基本上就是一行的事情。似乎听上去很简单，但对于一个搜索引擎级的爬虫，就不那么简单了，要把几千几万家新闻网站的新闻都及时抓取到也不是一件容易的事情。 我们先看看新闻爬虫的简单流程图： ![网络爬虫简单流程图](https://images-aiyc-1301641396.cos.ap-guangzhou.myqcloud.com/20200726082523.jpg) 从一些种子网页开始，种子网页往往是一些新闻网站的首页，爬虫抓取网页，从中提取网站 URL 放到网址池再进行抓取。这样就从几个网页开始，不断扩展到其它网页。爬虫抓取的网页也越来越多，提取出的新网网址也会成几何级数增长。 **如何能在最短时间抓取更多网址？** 这就是其中一个难度，这不是目标网址带来的，而是对我们自身自愿的考验：

*   我们的带宽够吗
*   我们的服务器够吗，单台不够就要分布式

**如何能及时抓取到最新的新闻？** 这是效率之外的另一个难度，如何保证及时性？几千家新闻网站，时刻都在发布最新新闻，爬虫在织网式抓取“旧”新闻的同时，如何兼顾获取“新”新闻呢？ **如何存储抓取到的海量新闻？** 爬虫织网式的爬取，会把每个网站几年前几十年前的新闻网页都给翻出来，从而获得海量的网页需要存储。就是存储上的难度。 **如何清理提取网内容？** 从新闻网页的 html 里面快速、准确提取想要的信息数据，比如标题、发布时间、正文内容等，这又带来内容提取上的难度。

## 2\. 网络爬虫难度二：需要登录才能抓到想要的数据

人是贪婪的，想要的数据无穷尽，但是很多数据不是你轻易就可以获得的。有一大类数据就是需要账户登录后才能看到，也就是说，爬虫请求时必须是登录状态才能抓取数据。 **如何获取登录状态？** 悦创前面已经说过了，http 协议的性质决定了登录状态就是一些 cookies，那么如何获得登录状态就是一个非常有难度的问题。 有些网站登录过程很简单，把账户、密码发给服务器，服务器验证通过返回表示已登录的 cookies。这样的网站，比较容易实现自动登录，爬虫运行过程全程无需人工干预，你就有更多时间喝茶、聊天、上 AI悦创看 Python。 **如何处理验证码?** 然而，网站们既然要求你登录了，他们就不会这么轻易放过你，要做的更绝才能让同学们善罢甘休，那就是上验证码！ 没错，就是变态的验证码！！作为见多识广的悦创，我还是经常识别不出验证码，惭愧惭愧。 据说，有人雇了一批大妈，进行人工识别验证码；也有，通过图像处理技术，尤其如今火热的深度学习、人工智能的技术，来自动识别验证码。 那么，当你写爬虫时遇到验证码该怎么办？

## 3\. 网络爬虫难度三：ajax 异步加载甚至 JavaScript 解密

前面的两个难度，都是靠我们研究数据加载过程，然后用 Python 代码可以重现出来，进行抓取的。 而遇到达第三个难度时，研究数据加载过程会让你十分痛苦、近乎崩溃。异步加载流程和服务器来来回回好多次，最后得到的数据还要通过 JavaScript 解密才能看到，这都是压垮同学们的最后一根稻草。 有没有什么终极大招可以破解呢？ 以上，总结了多年写爬虫的应验，得出这三个爬虫的难度等级，后面悦创将结合实际示例来讲解如何破解这些不同程度的难题。